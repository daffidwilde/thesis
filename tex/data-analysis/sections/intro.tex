In this section we will conduct a summative and exploratory analysis of the data
provided by the Cwm Taf University Health Board. The focus will be on the
distributions of, and relationships between, our non-trivial cost components
and a selection of other clinical attributes such as length of stay and number
of diagnoses. As we will see in the ensuing analysis, the bulk of this data
corresponds to short-stay and relatively low-cost spells of treatment. Following
this, we will endeavour to construct a framework for the analysis of slices
within the data which provide another dimension to our analysis through
comparison and contrast. However, before any such analysis begins, it is
important to understand the structure of data we are dealing with and how it has
been prepared.\\


\subsection{Data structure}\label{subsec:structure}

The data is comprised of approximately two and a half million episode-level
records for patients from across Wales that are being treated in the Prince
Charles and Royal Glamorgan hospitals. An episode is defined to be any
continuous period of care provided by the same consultant in the same place. For
instance, if a patient is admitted to a general medical ward for diagnosis and
testing, and then is referred to a specialist consultant in oncology their first
episode would end and be recorded, and a second episode of care would begin on
the oncology ward. Each of these episodes would correspond to a row in the
dataset. If the patient was then discharged, they would have completed a spell
with two episodes. In this analysis we will avoid looking at episode-level
statistics in favour of a patient's spell-level statistics. Since the
introduction of the `payment by results' system for financial flows, it has been
seen that focusing on the more granular episode statistics can lead to the
amount of resource or `activity' consumed by a hospital to treat that patient
being overestimated~\cite{spells_or_episodes}.\\

\noindent
Each episode is recorded as a row of roughly 250 attributes or columns,
including:
\begin{itemize}
    \item Personal identifiers such as identification numbers, age, registered
        GP practice, as well as spell admission and discharge dates;
    \item Other clinical quantities such as the number of diagnoses and
        procedures conducted in that episode, admission and discharge methods,
        and length of stay;
    \item A number of cost components which include the costs coming from
        various departments within the hospital, ward and overhead costs, and
        the cost of administration;
    \item Diagnosis (HRG, ICD10) and procedure (OPCS4) indicators, as well as
        Charlson index scores for a selection of common diagnoses.\\
\end{itemize}

Of the attributes listed here, we will focus on the cost components and other
clinical variables, paying particular attention to those attributes which are
considered to be linked to overall contribution to the cost of care. Other than
the cost components themselves, those attributes are: true length of stay,
maximum number of diagnoses and total number of procedures in a spell, and the
number of spells associated with any given patient.


\subsection{Cleaning the data}\label{subsec:formatting}

As with many \-- if not all \-- machine learning and knowledge discovery
applications, a substantial amount of preprocessing and formatting was required
to make the data consistent and suitable for our purposes. This process included
the removal of some superfluous columns which added no real information to the
dataset, and a number of rows that had been corrupted by some external storage
software during data collection. In addition to this, we reformatted some
columns whose entries were intended to be used as datetime objects later on.
